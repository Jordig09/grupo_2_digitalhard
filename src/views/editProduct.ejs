<!DOCTYPE html>
<html lang="es">
  <%- include('./partials/head.ejs',{styles}) %>
  <body>
    <%- include('./partials/header.ejs') %>
    <main>
      <h2 class="view-title">
        <%= typeof product !== 'undefined' ? "Editar" : "Crear" %> Producto
      </h2>
      <form action="" class="edit-form">
        <section>
          <h4>Información General</h4>
          <div class="input-container">
            <label for="product-name">Nombre de Producto</label>
            <input type="text" id="product-name" name="product-name" value="<%=
            typeof product !== 'undefined' ? product.name : ""%>" />
          </div>
          <div class="input-container">
            <label for="product-brand">Marca</label>
            <select name="product-brand" id="product-brand">
              <% brands.forEach(brand => { %>
              <option value="<%= brand.name %>" id="<%= brand.name %>" <% if(typeof product !== 'undefined'){ if(product.marca === brand.id) {%> selected <%} } %> >
                <%= brand.name %>
              </option>
              <%}); %>
            </select>
          </div>
          <div class="input-group">
            <div class="input-container">
              <label for="product-price">Precio</label>
              <input type="number" id="product-price" name="product-price"
              min="0" value="<%= typeof product !== 'undefined' ? product.price
              : ""%>" />
            </div>
            <div class="input-container">
              <label for="discount">Descuento (%)</label>
              <input type="number" id="discount" name="discount" min="0"
              max="100" value="<%= typeof product !== 'undefined' ?
              product.discount : ""%>" />
            </div>
          </div>
          <div class="input-container">
            <label for="description">Descripción del producto</label>
            <textarea name="description" id="description" rows="5">
<%= typeof product !== 'undefined' ? product.description : ""%></textarea
            >
          </div>
        </section>
        <section>
          <h4>Imágenes</h4>
          <div class="file-input">
            <input
              type="file"
              id="product-image"
              name="product-name"
              multiple
              accept=".png, .jpg, .jpeg, .webp"
            />
          </div>
          <div class="file-info">
            <p><i class="fas fa-info"></i></p>
            <p>Solo están permitidos archivos .png, .jpg, .jpeg y .webp</p>
          </div>
        </section>
        <section>
          <h4>Categorías</h4>
          <div class="box-search">
            <i class="fa-solid fa-magnifying-glass"></i>
            <input type="text" placeholder="Buscar Categorías..." />
          </div>
          <div class="category-checkboxes">
            <% categories.forEach(category => { %>
            <label>
              <input type="checkbox" id="<%= category.name %>" name="<%=
              category.name %>" value="<%= category.name %>" <% if(typeof product !== 'undefined'){
              product.category.forEach(cat => { if(category.id === cat) {%>
              checked <%} }); }%> /> <%= category.name %>
            </label>
            <%}); %>
          </div>
        </section>
        <section>
          <div class="attributes-container">
            <h4>Atributos</h4>
            <select name="attributes" id="attributes">
              <option value="simple-product" id="simple-product">
                Producto simple
              </option>
              <option value="variable-product" id="variable-product">
                Producto variable
              </option>
            </select>
          </div>
          <div id="simple-product-form" class="input-container <% if(typeof product !== 'undefined') if(product.type === 1){%> attributes-active <%}%>">
            <label for="stock-simple">Stock</label>
            <input
              type="number"
              name="stock-simple"
              id="stock-simple"
              min="0"
              value="<%= typeof product !== 'undefined' ?
              product.stock : ""%>"
            />
          </div>
          <div class="<% if(typeof product !== 'undefined') if(product.type === 0){%> attributes-active <%} if(typeof product === 'undefined') {%> attributes-active <% } %>" id="variable-product-form">
            <div class="input-container">
              <label for="new-attribute">Nuevo atributo</label>
              <input
                type="text"
                name="new-attribute"
                id="new-attribute"
                placeholder="Ej: color"
              />
            </div>
            <div class="input-container">
              <label for="attribute-variant">Cantidad de variantes</label>
              <input
                type="number"
                name="attribute-variant"
                id="attribute-variant"
                min="0"
              />
            </div>
            <input
              type="submit"
              id="attribute-submit"
              value="Agregar atributo"
            />
          </div>
        </section>
        <div class="submit">
          <input type="submit" id="submit" value="<%= typeof product !==
          'undefined' ? "Editar" : "Crear" %>"/>
        </div>
      </form>
    </main>
    <%- include('./partials/footer.ejs') %>
  </body>
  <script src="/js/index.js"></script>
  <script src="/js/editProduct.js"></script>
</html>
